<!doctype html>
<html lang="en" class="h-full" data-astro-transition-scope="astro-jtmjwenq-3">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="TutorialKit" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content="Astro v4.10.3" />
    <title>Vite Plugin / Env Plugin / Env variables in load hook</title>
    <script src="/tutorial-vite-plugin/coi-serviceworker.js"></script>
    <link
      rel="icon"
      type="image/svg+xml"
      href="/tutorial-vite-plugin/favicon.svg"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <meta name="astro-view-transitions-enabled" content="true" />
    <meta name="astro-view-transitions-fallback" content="animate" />
    <link
      rel="stylesheet"
      href="/tutorial-vite-plugin/_astro/_slug_.DRuEjq2g.css"
    />
    <link
      rel="stylesheet"
      href="/tutorial-vite-plugin/_astro/_slug_.msXv60BF.css"
    />
    <script
      type="module"
      src="/tutorial-vite-plugin/_astro/hoisted.DVu4Hrmu.js"
    ></script>
    <style>
      [data-astro-transition-scope="astro-jtmjwenq-3"] {
        view-transition-name: astro-jtmjwenq-3;
      }
      @layer astro {
        ::view-transition-old(astro-jtmjwenq-3) {
          animation: none;
          opacity: 0;
          mix-blend-mode: normal;
        }
        ::view-transition-new(astro-jtmjwenq-3) {
          animation: none;
          mix-blend-mode: normal;
        }
        ::view-transition-group(astro-jtmjwenq-3) {
          animation: none;
        }
      }
      [data-astro-transition-fallback="old"]
        [data-astro-transition-scope="astro-jtmjwenq-3"],
      [data-astro-transition-fallback="old"][data-astro-transition-scope="astro-jtmjwenq-3"] {
        animation: none;
        mix-blend-mode: normal;
      }
      [data-astro-transition-fallback="new"]
        [data-astro-transition-scope="astro-jtmjwenq-3"],
      [data-astro-transition-fallback="new"][data-astro-transition-scope="astro-jtmjwenq-3"] {
        animation: none;
        mix-blend-mode: normal;
      }
    </style>
  </head>
  <body class="h-full text-black">
    <div id="previews-container"></div>
    <main
      class="max-w-full flex flex-col h-screen overflow-hidden"
      data-swap-root
    >
      <nav
        class="bg-tk-elements-topBar-backgroundColor border-b border-tk-elements-app-borderColor flex max-w-full items-center p-3 px-4 min-h-[56px]"
      >
        <div class="flex flex-1">
          <a
            href="/"
            class="flex items-center text-tk-elements-topBar-logo-color hover:text-tk-elements-topBar-logo-colorHover"
          >
            <img
              class="h-5 w-auto dark:hidden"
              src="/tutorial-vite-plugin/logo.svg"
            />
            <img
              class="h-5 w-auto hidden dark:inline-block"
              src="/tutorial-vite-plugin/logo.svg"
            />
          </a>
        </div>
        <div>
          <style>
            astro-island,
            astro-slot,
            astro-static-slot {
              display: contents;
            }
          </style>
          <script>
            (() => {
              var e = async (t) => {
                await (
                  await t()
                )();
              };
              (self.Astro || (self.Astro = {})).load = e;
              window.dispatchEvent(new Event("astro:load"));
            })();
            (() => {
              var A = Object.defineProperty;
              var g = (i, o, a) =>
                o in i
                  ? A(i, o, {
                      enumerable: !0,
                      configurable: !0,
                      writable: !0,
                      value: a,
                    })
                  : (i[o] = a);
              var d = (i, o, a) => g(i, typeof o != "symbol" ? o + "" : o, a);
              {
                let i = {
                    0: (t) => m(t),
                    1: (t) => a(t),
                    2: (t) => new RegExp(t),
                    3: (t) => new Date(t),
                    4: (t) => new Map(a(t)),
                    5: (t) => new Set(a(t)),
                    6: (t) => BigInt(t),
                    7: (t) => new URL(t),
                    8: (t) => new Uint8Array(t),
                    9: (t) => new Uint16Array(t),
                    10: (t) => new Uint32Array(t),
                  },
                  o = (t) => {
                    let [l, e] = t;
                    return l in i ? i[l](e) : void 0;
                  },
                  a = (t) => t.map(o),
                  m = (t) =>
                    typeof t != "object" || t === null
                      ? t
                      : Object.fromEntries(
                          Object.entries(t).map(([l, e]) => [l, o(e)])
                        );
                class y extends HTMLElement {
                  constructor() {
                    super(...arguments);
                    d(this, "Component");
                    d(this, "hydrator");
                    d(this, "hydrate", async () => {
                      var b;
                      if (!this.hydrator || !this.isConnected) return;
                      let e =
                        (b = this.parentElement) == null
                          ? void 0
                          : b.closest("astro-island[ssr]");
                      if (e) {
                        e.addEventListener("astro:hydrate", this.hydrate, {
                          once: !0,
                        });
                        return;
                      }
                      let c = this.querySelectorAll("astro-slot"),
                        n = {},
                        h = this.querySelectorAll(
                          "template[data-astro-template]"
                        );
                      for (let r of h) {
                        let s = r.closest(this.tagName);
                        s != null &&
                          s.isSameNode(this) &&
                          ((n[
                            r.getAttribute("data-astro-template") || "default"
                          ] = r.innerHTML),
                          r.remove());
                      }
                      for (let r of c) {
                        let s = r.closest(this.tagName);
                        s != null &&
                          s.isSameNode(this) &&
                          (n[r.getAttribute("name") || "default"] =
                            r.innerHTML);
                      }
                      let p;
                      try {
                        p = this.hasAttribute("props")
                          ? m(JSON.parse(this.getAttribute("props")))
                          : {};
                      } catch (r) {
                        let s =
                            this.getAttribute("component-url") || "<unknown>",
                          v = this.getAttribute("component-export");
                        throw (
                          (v && (s += ` (export ${v})`),
                          console.error(
                            `[hydrate] Error parsing props for component ${s}`,
                            this.getAttribute("props"),
                            r
                          ),
                          r)
                        );
                      }
                      let u;
                      await this.hydrator(this)(this.Component, p, n, {
                        client: this.getAttribute("client"),
                      }),
                        this.removeAttribute("ssr"),
                        this.dispatchEvent(new CustomEvent("astro:hydrate"));
                    });
                    d(this, "unmount", () => {
                      this.isConnected ||
                        this.dispatchEvent(new CustomEvent("astro:unmount"));
                    });
                  }
                  disconnectedCallback() {
                    document.removeEventListener(
                      "astro:after-swap",
                      this.unmount
                    ),
                      document.addEventListener(
                        "astro:after-swap",
                        this.unmount,
                        { once: !0 }
                      );
                  }
                  connectedCallback() {
                    if (
                      !this.hasAttribute("await-children") ||
                      document.readyState === "interactive" ||
                      document.readyState === "complete"
                    )
                      this.childrenConnectedCallback();
                    else {
                      let e = () => {
                          document.removeEventListener("DOMContentLoaded", e),
                            c.disconnect(),
                            this.childrenConnectedCallback();
                        },
                        c = new MutationObserver(() => {
                          var n;
                          ((n = this.lastChild) == null
                            ? void 0
                            : n.nodeType) === Node.COMMENT_NODE &&
                            this.lastChild.nodeValue === "astro:end" &&
                            (this.lastChild.remove(), e());
                        });
                      c.observe(this, { childList: !0 }),
                        document.addEventListener("DOMContentLoaded", e);
                    }
                  }
                  async childrenConnectedCallback() {
                    let e = this.getAttribute("before-hydration-url");
                    e && (await import(e)), this.start();
                  }
                  async start() {
                    let e = JSON.parse(this.getAttribute("opts")),
                      c = this.getAttribute("client");
                    if (Astro[c] === void 0) {
                      window.addEventListener(
                        `astro:${c}`,
                        () => this.start(),
                        { once: !0 }
                      );
                      return;
                    }
                    try {
                      await Astro[c](
                        async () => {
                          let n = this.getAttribute("renderer-url"),
                            [h, { default: p }] = await Promise.all([
                              import(this.getAttribute("component-url")),
                              n ? import(n) : () => () => {},
                            ]),
                            u =
                              this.getAttribute("component-export") ||
                              "default";
                          if (!u.includes(".")) this.Component = h[u];
                          else {
                            this.Component = h;
                            for (let f of u.split("."))
                              this.Component = this.Component[f];
                          }
                          return (this.hydrator = p), this.hydrate;
                        },
                        e,
                        this
                      );
                    } catch (n) {
                      console.error(
                        `[astro-island] Error hydrating ${this.getAttribute("component-url")}`,
                        n
                      );
                    }
                  }
                  attributeChangedCallback() {
                    this.hydrate();
                  }
                }
                d(y, "observedAttributes", ["props"]),
                  customElements.get("astro-island") ||
                    customElements.define("astro-island", y);
              }
            })();
          </script>
          <astro-island
            uid="2cvFnq"
            prefix="r0"
            component-url="/tutorial-vite-plugin/_astro/ThemeSwitch.CBQF5sbf.js"
            component-export="ThemeSwitch"
            renderer-url="/tutorial-vite-plugin/_astro/client.BKHx8Gce.js"
            props='{"data-astro-transition-persist":[0,"astro-kbs5hqxk-2"]}'
            ssr=""
            client="load"
            opts='{"name":"ThemeSwitch","value":true}'
            data-astro-transition-persist="astro-kbs5hqxk-2"
          ></astro-island>
        </div>
        <div></div>
      </nav>
      <resizable-panel
        class="h-full overflow-hidden"
        data-id="main"
        data-type="horizontal"
        data-pos="40%"
        data-min="30%"
        data-priority="min"
        data-max="60%"
        data-astro-cid-6uew3run
      >
        <div
          class="container max-w-full horizontal"
          style="--pos: 40%"
          data-astro-cid-6uew3run
        >
          <!-- It's important to keep the inline script here because it restores the position and blocks rendering to avoid flickering -->
          <script>
            (function () {
              const id = "main";
              const hasSidePanel = true;

              if (!hasSidePanel) {
                // if we don't have a side panel, we don't have to restore the handle
                return;
              }

              const sessionStorageKey = `tk_resizable_panel_${id}`;

              const $container = document.querySelector(
                `resizable-panel[data-id="${id}"] > .container`
              );
              const pos = sessionStorage.getItem(sessionStorageKey);

              if (pos) {
                $container.style.setProperty("--pos", pos);
              }
            })();
          </script>
          <div class="panel" data-astro-cid-6uew3run>
            <div
              class="h-full flex flex-col bg-tk-elements-app-backgroundColor text-tk-elements-app-textColor"
            >
              <astro-island
                uid="Z1S0aaS"
                prefix="r1"
                component-url="/tutorial-vite-plugin/_astro/NavWrapper.B7NKX6MK.js"
                component-export="NavWrapper"
                renderer-url="/tutorial-vite-plugin/_astro/client.BKHx8Gce.js"
                props='{"lesson":[0,{"data":[0,{"mainCommand":[0,""],"prepareCommands":[1,[[1,[[0,"npm install"],[0,"Installing dependencies"]]]]],"template":[0,"env-plugin"],"terminal":[0,{"panels":[1,[[1,[[0,"terminal"],[0,"Terminal"]]]]],"activePanel":[0,1]}],"focus":[0,"/vite.config.ts"],"title":[0,"Env variables in load hook"],"type":[0,"lesson"]}],"id":[0,"4-env-variables-in-load-hook"],"order":[0,3],"part":[0,{"id":[0,"1-vite-plugin"],"title":[0,"Vite Plugin"]}],"chapter":[0,{"id":[0,"2-env-plugin"],"title":[0,"Env Plugin"]}],"Markdown":[0,null],"slug":[0,"4-env-variables-in-load-hook"],"files":[1,[[0,"1-vite-plugin-2-env-plugin-4-env-variables-in-load-hook-files.json"],[1,[[0,"/index.js"],[0,"/vite.config.ts"]]]]],"solution":[1,[[0,"1-vite-plugin-2-env-plugin-4-env-variables-in-load-hook-solution.json"],[1,[[0,"/index.js"],[0,"/vite.config.ts"]]]]],"prev":[0,{"title":[0,"Resolving id of virtual module"],"href":[0,"/tutorial-vite-plugin/1-vite-plugin/2-env-plugin/3-resolve-id-of-virtual-module"]}],"next":[0,{"title":[0,"Summary"],"href":[0,"/tutorial-vite-plugin/1-vite-plugin/2-env-plugin/5-summarize-env-plugin"]}]}],"navList":[1,[[0,{"id":[0,"1-vite-plugin"],"title":[0,"Vite Plugin"],"sections":[1,[[0,{"id":[0,"1-yaml-plugin"],"title":[0,"YAML Plugin"],"sections":[1,[[0,{"id":[0,"1-importing-yaml-files"],"title":[0,"Importing YAML files"],"href":[0,"/tutorial-vite-plugin/1-vite-plugin/1-yaml-plugin/1-importing-yaml-files"]}],[0,{"id":[0,"2-defining-custom-plugin"],"title":[0,"Defining custom plugin"],"href":[0,"/tutorial-vite-plugin/1-vite-plugin/1-yaml-plugin/2-defining-custom-plugin"]}],[0,{"id":[0,"3-defining-load-hook"],"title":[0,"Defining load hook"],"href":[0,"/tutorial-vite-plugin/1-vite-plugin/1-yaml-plugin/3-defining-load-hook"]}],[0,{"id":[0,"4-processing-yaml-files"],"title":[0,"Processing YAML files"],"href":[0,"/tutorial-vite-plugin/1-vite-plugin/1-yaml-plugin/4-processing-yaml-files"]}],[0,{"id":[0,"5-summarize-yaml-plugin"],"title":[0,"Summary"],"href":[0,"/tutorial-vite-plugin/1-vite-plugin/1-yaml-plugin/5-summarize-yaml-plugin"]}]]]}],[0,{"id":[0,"2-env-plugin"],"title":[0,"Env Plugin"],"sections":[1,[[0,{"id":[0,"1-env-vars-in-node"],"title":[0,"Environment Variables in Node"],"href":[0,"/tutorial-vite-plugin/1-vite-plugin/2-env-plugin/1-env-vars-in-node"]}],[0,{"id":[0,"2-importing-virtual-module"],"title":[0,"Importing virtual module"],"href":[0,"/tutorial-vite-plugin/1-vite-plugin/2-env-plugin/2-importing-virtual-module"]}],[0,{"id":[0,"3-resolve-id-of-virtual-module"],"title":[0,"Resolving id of virtual module"],"href":[0,"/tutorial-vite-plugin/1-vite-plugin/2-env-plugin/3-resolve-id-of-virtual-module"]}],[0,{"id":[0,"4-env-variables-in-load-hook"],"title":[0,"Env variables in load hook"],"href":[0,"/tutorial-vite-plugin/1-vite-plugin/2-env-plugin/4-env-variables-in-load-hook"]}],[0,{"id":[0,"5-summarize-env-plugin"],"title":[0,"Summary"],"href":[0,"/tutorial-vite-plugin/1-vite-plugin/2-env-plugin/5-summarize-env-plugin"]}]]]}]]]}]]]}'
                ssr=""
                client="load"
                opts='{"name":"Nav","value":true}'
                await-children=""
                ><header
                  class="grid grid-cols-[auto_minmax(0,1fr)_auto] h-[82px] gap-0.5 py-4 px-1 text-sm"
                >
                  <a
                    class="flex cursor-pointer h-full items-center justify-center w-[40px] text-tk-elements-breadcrumbs-navButton-iconColor hover:text-tk-elements-breadcrumbs-navButton-iconColorHover"
                    aria-disabled="false"
                    href="/tutorial-vite-plugin/1-vite-plugin/2-env-plugin/3-resolve-id-of-virtual-module"
                    ><span class="i-ph-arrow-left scale-120"></span
                  ></a>
                  <div class="relative">
                    <div
                      data-state="closed"
                      class="_NavContainer_ccqmw_41 absolute z-1 left-0 transition-[background,box-shadow] duration-0 right-0 rounded-[8px] border overflow-hidden z-50"
                    >
                      <button
                        class="_ToggleButton_ccqmw_53 flex-1 flex items-center text-left py-3 px-3 w-full overflow-hidden"
                      >
                        <div
                          class="flex items-center gap-1 font-light truncate"
                        >
                          <span>Vite Plugin</span
                          ><span class="_Divider_ccqmw_68">/</span
                          ><span>Env Plugin</span
                          ><span class="_Divider_ccqmw_68">/</span
                          ><strong class="font-semibold"
                            >Env variables in load hook</strong
                          >
                        </div>
                        <div
                          class="_ToggleButtonIcon_ccqmw_80 ml-auto w-[30px] i-ph-caret-down-bold"
                        ></div>
                      </button>
                    </div>
                  </div>
                  <a
                    class="flex cursor-pointer h-full items-center justify-center w-[40px] text-tk-elements-breadcrumbs-navButton-iconColor hover:text-tk-elements-breadcrumbs-navButton-iconColorHover"
                    aria-disabled="false"
                    href="/tutorial-vite-plugin/1-vite-plugin/2-env-plugin/5-summarize-env-plugin"
                    ><span class="i-ph-arrow-right scale-120"></span
                  ></a>
                </header>
                <!--astro:end--></astro-island
              >
              <div class="h-full overflow-auto scrollbar-transparent p-8">
                <div
                  class="markdown-content text-tk-elements-content-textColor"
                >
                  <h1 id="env-variables-in-load-hook">
                    Env variables in load hook
                  </h1>
                  <p>
                    We are now able to intercept loading of the virtual module
                    and have prevented other plugins from colliding with it.
                  </p>
                  <p>
                    Next we’ll need to handle the actual environment variables.
                    As environment variables are an easy way to expose secrets,
                    let’s allow our plugin to only expose variables that are
                    prefixed with <code>TUTORIAL_</code>:
                  </p>
                  <div class="expressive-code">
                    <link
                      rel="stylesheet"
                      href="/tutorial-vite-plugin/_astro/ec.hcu7t.css"
                    />
                    <script
                      type="module"
                      src="/tutorial-vite-plugin/_astro/ec.3zb7u.js"
                    ></script>
                    <figure class="frame">
                      <figcaption class="header"></figcaption>
                      <pre
                        data-language="ts"
                      ><code><div class="ec-line"><div class="code"><span style="--0:#569CD6;--1:#0000FF">function</span><span style="--0:#D4D4D4;--1:#000000"> </span><span style="--0:#DCDCAA;--1:#795E26">getTutorialEnvVariables</span><span style="--0:#D4D4D4;--1:#000000">() {</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#569CD6;--1:#0000FF">const</span><span style="--0:#D4D4D4;--1:#000000"> </span><span style="--0:#4FC1FF;--1:#006BB8">output</span><span style="--0:#D4D4D4;--1:#000000"> = {};</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#569CD6;--1:#0000FF">const</span><span style="--0:#D4D4D4;--1:#000000"> </span><span style="--0:#4FC1FF;--1:#006BB8">names</span><span style="--0:#D4D4D4;--1:#000000"> = </span><span style="--0:#9CDCFE;--1:#001080">Object</span><span style="--0:#D4D4D4;--1:#000000">.</span><span style="--0:#DCDCAA;--1:#795E26">keys</span><span style="--0:#D4D4D4;--1:#000000">(</span><span style="--0:#9CDCFE;--1:#001080">process</span><span style="--0:#D4D4D4;--1:#000000">.</span><span style="--0:#9CDCFE;--1:#001080">env</span><span style="--0:#D4D4D4;--1:#000000">);</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C586C0;--1:#AC00D8">for</span><span style="--0:#D4D4D4;--1:#000000"> (</span><span style="--0:#569CD6;--1:#0000FF">const</span><span style="--0:#D4D4D4;--1:#000000"> </span><span style="--0:#4FC1FF;--1:#006BB8">name</span><span style="--0:#D4D4D4;--1:#000000"> </span><span style="--0:#569CD6;--1:#0000FF">of</span><span style="--0:#D4D4D4;--1:#000000"> </span><span style="--0:#9CDCFE;--1:#001080">names</span><span style="--0:#D4D4D4;--1:#000000">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C586C0;--1:#AC00D8">if</span><span style="--0:#D4D4D4;--1:#000000"> (</span><span style="--0:#9CDCFE;--1:#001080">name</span><span style="--0:#D4D4D4;--1:#000000">.</span><span style="--0:#DCDCAA;--1:#795E26">startsWith</span><span style="--0:#D4D4D4;--1:#000000">(</span><span style="--0:#CE9178;--1:#A31515">"TUTORIAL_"</span><span style="--0:#D4D4D4;--1:#000000">)) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#9CDCFE;--1:#001080">output</span><span style="--0:#D4D4D4;--1:#000000">[</span><span style="--0:#9CDCFE;--1:#001080">name</span><span style="--0:#D4D4D4;--1:#000000">] = </span><span style="--0:#9CDCFE;--1:#001080">process</span><span style="--0:#D4D4D4;--1:#000000">.</span><span style="--0:#9CDCFE;--1:#001080">env</span><span style="--0:#D4D4D4;--1:#000000">[</span><span style="--0:#9CDCFE;--1:#001080">name</span><span style="--0:#D4D4D4;--1:#000000">];</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D4D4D4;--1:#000000">    </span></span><span style="--0:#D4D4D4;--1:#000000">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D4D4D4;--1:#000000">  </span></span><span style="--0:#D4D4D4;--1:#000000">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C586C0;--1:#AC00D8">return</span><span style="--0:#D4D4D4;--1:#000000"> </span><span style="--0:#9CDCFE;--1:#001080">output</span><span style="--0:#D4D4D4;--1:#000000">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D4D4D4;--1:#000000">}</span></div></div></code></pre>
                      <div class="copy">
                        <button
                          title="Copy to clipboard"
                          data-copied="Copied!"
                          data-code="function getTutorialEnvVariables() {  const output = {};  const names = Object.keys(process.env);  for (const name of names) {    if (name.startsWith(&#x22;TUTORIAL_&#x22;)) {      output[name] = process.env[name];    }  }  return output;}"
                        >
                          <div></div>
                        </button>
                      </div>
                    </figure>
                  </div>
                  <p>
                    Let’s use <code>getTutorialEnvVariables</code> in the laod
                    hook to collect all <code>TUTORIAL_</code> prefixed
                    environment variables and return them as a object.
                  </p>
                  <div class="expressive-code">
                    <figure class="frame">
                      <figcaption class="header"></figcaption>
                      <pre
                        data-language="ts"
                      ><code><div class="ec-line"><div class="code"><span style="--0:#DCDCAA;--1:#795E26">load</span><span style="--0:#D4D4D4;--1:#000000">(</span><span style="--0:#9CDCFE;--1:#001080">id</span><span style="--0:#D4D4D4;--1:#000000">, </span><span style="--0:#9CDCFE;--1:#001080">options</span><span style="--0:#D4D4D4;--1:#000000">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C586C0;--1:#AC00D8">if</span><span style="--0:#D4D4D4;--1:#000000"> (</span><span style="--0:#9CDCFE;--1:#001080">id</span><span style="--0:#D4D4D4;--1:#000000"> === </span><span style="--0:#CE9178;--1:#A31515">"</span><span style="--0:#D7BA7D;--1:#D40000">\0</span><span style="--0:#CE9178;--1:#A31515">virtual:tutorial-env"</span><span style="--0:#D4D4D4;--1:#000000">) {</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">    </span><span style="--0:#7cb3df;--1:#0000FF">const</span><span style="--0:#D4D4D4;--1:#000000"> </span><span style="--0:#4FC1FF;--1:#005593">envVars</span><span style="--0:#D4D4D4;--1:#000000"> = </span><span style="--0:#DCDCAA;--1:#664f20">getTutorialEnvVariables</span><span style="--0:#D4D4D4;--1:#000000">();</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">    </span><span style="--0:#d09dcc;--1:#8c00b0">return</span><span style="--0:#D4D4D4;--1:#000000"> </span><span style="--0:#d5a18c;--1:#A31515">`export default </span><span style="--0:#7cb3df;--1:#0000FF">${</span><span style="--0:#4FC1FF;--1:#005593">JSON</span><span style="--0:#D4D4D4;--1:#000000">.</span><span style="--0:#DCDCAA;--1:#664f20">stringify</span><span style="--0:#D4D4D4;--1:#000000">(</span><span style="--0:#9CDCFE;--1:#001080">envVars</span><span style="--0:#D4D4D4;--1:#000000">)</span><span style="--0:#7cb3df;--1:#0000FF">}</span><span style="--0:#d5a18c;--1:#A31515">`</span><span style="--0:#D4D4D4;--1:#000000">;</span></div></div><div class="ec-line highlight del"><div class="code"><span class="indent">    </span><span style="--0:#cf9bcb;--1:#8900ac">return</span><span style="--0:#D4D4D4;--1:#000000"> </span><span style="--0:#d5a08b;--1:#A31515">"export default 'This should work 🤔'"</span><span style="--0:#D4D4D4;--1:#000000">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D4D4D4;--1:#000000">  </span></span><span style="--0:#D4D4D4;--1:#000000">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D4D4D4;--1:#000000">},</span></div></div></code></pre>
                      <div class="copy">
                        <button
                          title="Copy to clipboard"
                          data-copied="Copied!"
                          data-code="load(id, options) {  if (id === &#x22;\0virtual:tutorial-env&#x22;) {    const envVars = getTutorialEnvVariables();    return &#x60;export default ${JSON.stringify(envVars)}&#x60;;    return &#x22;export default &#x27;This should work 🤔&#x27;&#x22;;  }},"
                        >
                          <div></div>
                        </button>
                      </div>
                    </figure>
                  </div>
                  <p>
                    Next let’s open up the terminal and start Vite server while
                    providing an environment variable:
                  </p>
                  <div class="expressive-code">
                    <figure class="frame is-terminal">
                      <figcaption class="header">
                        <span class="title"></span
                        ><span class="sr-only">Terminal window</span>
                      </figcaption>
                      <pre
                        data-language="sh"
                      ><code><div class="ec-line"><div class="code"><span style="--0:#9CDCFE;--1:#001080">TUTORIAL_MY_MESSAGE</span><span style="--0:#D4D4D4;--1:#000000">=</span><span style="--0:#CE9178;--1:#A31515">"Hello world"</span><span style="--0:#D4D4D4;--1:#000000"> </span><span style="--0:#DCDCAA;--1:#795E26">npm</span><span style="--0:#D4D4D4;--1:#000000"> </span><span style="--0:#CE9178;--1:#A31515">run</span><span style="--0:#D4D4D4;--1:#000000"> </span><span style="--0:#CE9178;--1:#A31515">dev</span></div></div></code></pre>
                      <div class="copy">
                        <button
                          title="Copy to clipboard"
                          data-copied="Copied!"
                          data-code="TUTORIAL_MY_MESSAGE=&#x22;Hello world&#x22; npm run dev"
                        >
                          <div></div>
                        </button>
                      </div>
                    </figure>
                  </div>
                  <p>
                    The passed environment variable should now appear in the
                    preview tab. ✅
                  </p>
                </div>
                <div class="grid grid-cols-[1fr_1fr] gap-4 mt-8">
                  <div class="flex">
                    <a
                      class="content-nav-card group flex flex-col bg-tk-elements-navCard-backgroundColor hover:bg-tk-elements-navCard-backgroundColorHover flex-1 p-4 border border-tk-elements-navCard-borderColor hover:border-tk-elements-navCard-borderColorHover text-tk-elements-navCard-textColor hover:text-tk-elements-navCard-textColorHover rounded-md cursor-pointer"
                      href="/tutorial-vite-plugin/1-vite-plugin/2-env-plugin/3-resolve-id-of-virtual-module"
                    >
                      <span
                        class="icon text-tk-elements-navCard-iconColor i-ph-arrow-left pointer-events-none h-7 w-7 mb-2 group-hover:text-tk-elements-navCard-iconColorHover"
                      ></span>
                      <span class="line-clamp-2"
                        >Resolving id of virtual module</span
                      >
                    </a>
                  </div>
                  <div class="flex">
                    <a
                      class="content-nav-card group flex flex-col bg-tk-elements-navCard-backgroundColor hover:bg-tk-elements-navCard-backgroundColorHover flex-1 p-4 border border-tk-elements-navCard-borderColor hover:border-tk-elements-navCard-borderColorHover text-tk-elements-navCard-textColor hover:text-tk-elements-navCard-textColorHover rounded-md cursor-pointer text-right items-end"
                      href="/tutorial-vite-plugin/1-vite-plugin/2-env-plugin/5-summarize-env-plugin"
                    >
                      <span
                        class="icon text-tk-elements-navCard-iconColor i-ph-arrow-right pointer-events-none h-7 w-7 mb-2 group-hover:text-tk-elements-navCard-iconColorHover"
                      ></span>
                      <span class="line-clamp-2">Summary</span>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="panel" data-astro-cid-6uew3run>
            <div class="h-full border-l border-tk-elements-app-borderColor">
              <astro-island
                uid="ZBH3vK"
                prefix="r2"
                component-url="/tutorial-vite-plugin/_astro/WorkspacePanelWrapper.Cuii6WZ3.js"
                component-export="WorkspacePanelWrapper"
                renderer-url="/tutorial-vite-plugin/_astro/client.BKHx8Gce.js"
                props='{"lesson":[0,{"data":[0,{"mainCommand":[0,""],"prepareCommands":[1,[[1,[[0,"npm install"],[0,"Installing dependencies"]]]]],"template":[0,"env-plugin"],"terminal":[0,{"panels":[1,[[1,[[0,"terminal"],[0,"Terminal"]]]]],"activePanel":[0,1]}],"focus":[0,"/vite.config.ts"],"title":[0,"Env variables in load hook"],"type":[0,"lesson"]}],"id":[0,"4-env-variables-in-load-hook"],"order":[0,3],"part":[0,{"id":[0,"1-vite-plugin"],"title":[0,"Vite Plugin"]}],"chapter":[0,{"id":[0,"2-env-plugin"],"title":[0,"Env Plugin"]}],"Markdown":[0,null],"slug":[0,"4-env-variables-in-load-hook"],"files":[1,[[0,"1-vite-plugin-2-env-plugin-4-env-variables-in-load-hook-files.json"],[1,[[0,"/index.js"],[0,"/vite.config.ts"]]]]],"solution":[1,[[0,"1-vite-plugin-2-env-plugin-4-env-variables-in-load-hook-solution.json"],[1,[[0,"/index.js"],[0,"/vite.config.ts"]]]]],"prev":[0,{"title":[0,"Resolving id of virtual module"],"href":[0,"/tutorial-vite-plugin/1-vite-plugin/2-env-plugin/3-resolve-id-of-virtual-module"]}],"next":[0,{"title":[0,"Summary"],"href":[0,"/tutorial-vite-plugin/1-vite-plugin/2-env-plugin/5-summarize-env-plugin"]}]}],"data-astro-transition-persist":[0,"astro-jzrl3qot-1"]}'
                ssr=""
                client="load"
                opts='{"name":"WorkspacePanel","value":true}'
                data-astro-transition-persist="astro-jzrl3qot-1"
                await-children=""
                ><div
                  class=""
                  style="
                    display: flex;
                    flex-direction: column;
                    height: 100%;
                    overflow: hidden;
                    width: 100%;
                  "
                  data-panel-group=""
                  data-panel-group-direction="vertical"
                  data-panel-group-id=":r2R0:"
                >
                  <div
                    class=""
                    id="editor-opened"
                    style="
                      flex-basis: 0;
                      flex-grow: 50;
                      flex-shrink: 1;
                      overflow: hidden;
                    "
                    data-panel=""
                    data-panel-group-id=":r2R0:"
                    data-panel-id="editor-opened"
                    data-panel-size="50.0"
                  >
                    <div
                      class="bg-tk-elements-app-backgroundColor"
                      style="
                        display: flex;
                        flex-direction: row;
                        height: 100%;
                        overflow: hidden;
                        width: 100%;
                      "
                      data-panel-group=""
                      data-panel-group-direction="horizontal"
                      data-panel-group-id=":r2Rj:"
                    >
                      <div
                        class="flex flex-col"
                        style="
                          flex-basis: 0;
                          flex-grow: 0;
                          flex-shrink: 1;
                          overflow: hidden;
                        "
                        data-panel=""
                        data-panel-collapsible="true"
                        data-panel-group-id=":r2Rj:"
                        data-panel-id=":r2R3j:"
                        data-panel-size="0.0"
                      >
                        <div
                          class="panel-header border-r border-b border-tk-elements-app-borderColor"
                        >
                          <div class="panel-title">
                            <div
                              class="panel-icon i-ph-tree-structure-duotone shrink-0"
                            ></div>
                            <span class="text-sm">Files</span>
                          </div>
                        </div>
                        <div
                          class="flex-grow py-2 border-r border-tk-elements-app-borderColor text-sm bg-tk-elements-fileTree-backgroundColor"
                        >
                          <button
                            class="flex items-center gap-2 w-full pr-2 border-2 border-transparent text-faded group bg-tk-elements-fileTree-file-backgroundColor hover:bg-tk-elements-fileTree-file-backgroundColorHover text-tk-elements-fileTree-file-textColor hover:text-tk-elements-fileTree-file-textColorHover"
                            style="padding-left: 12px"
                          >
                            <div
                              class="scale-120 shrink-0 i-ph-file-duotone text-tk-elements-fileTree-file-iconColor group-hover:text-tk-elements-fileTree-file-iconColorHover"
                            ></div>
                            <span>index.js</span></button
                          ><button
                            class="flex items-center gap-2 w-full pr-2 border-2 border-transparent text-faded group bg-tk-elements-fileTree-file-backgroundColor hover:bg-tk-elements-fileTree-file-backgroundColorHover text-tk-elements-fileTree-file-textColor hover:text-tk-elements-fileTree-file-textColorHover"
                            style="padding-left: 12px"
                          >
                            <div
                              class="scale-120 shrink-0 i-ph-file-duotone text-tk-elements-fileTree-file-iconColor group-hover:text-tk-elements-fileTree-file-iconColorHover"
                            ></div>
                            <span>vite.config.ts</span>
                          </button>
                        </div>
                      </div>
                      <div
                        class="_PanelResizeHandle_1dq9w_1"
                        role="separator"
                        style="touch-action: none; user-select: none"
                        tabindex="0"
                        data-panel-group-direction="horizontal"
                        data-panel-group-id=":r2Rj:"
                        data-resize-handle=""
                        data-resize-handle-state="inactive"
                        data-panel-resize-handle-enabled="true"
                        data-panel-resize-handle-id=":r2R5j:"
                      ></div>
                      <div
                        class="flex flex-col"
                        style="
                          flex-basis: 0;
                          flex-grow: 100;
                          flex-shrink: 1;
                          overflow: hidden;
                        "
                        data-panel=""
                        data-panel-group-id=":r2Rj:"
                        data-panel-id=":r2R7j:"
                        data-panel-size="100.0"
                      >
                        <div
                          class="panel-header border-b border-tk-elements-app-borderColor flex justify-between"
                        >
                          <div class="panel-title">
                            <div class="panel-icon scale-125"></div>
                            <span class="text-sm"></span>
                          </div>
                          <button class="panel-button px-2 py-0.5 -mr-1 -my-1">
                            <div
                              class="i-ph-clock-counter-clockwise-duotone"
                            ></div>
                            Reset
                          </button>
                        </div>
                        <div class="h-full flex-1 overflow-hidden">
                          <div class="h-full relative">
                            <div class="h-full overflow-hidden"></div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div
                    class="_PanelResizeHandle_1dq9w_1"
                    role="separator"
                    style="touch-action: none; user-select: none"
                    tabindex="0"
                    data-panel-group-direction="vertical"
                    data-panel-group-id=":r2R0:"
                    data-resize-handle=""
                    data-resize-handle-state="inactive"
                    data-panel-resize-handle-enabled="true"
                    data-panel-resize-handle-id=":r2R5:"
                  ></div>
                  <div
                    class="border-t border-tk-elements-app-borderColor"
                    id="previews-opened"
                    style="
                      flex-basis: 0;
                      flex-grow: 50;
                      flex-shrink: 1;
                      overflow: hidden;
                    "
                    data-panel=""
                    data-panel-group-id=":r2R0:"
                    data-panel-id="previews-opened"
                    data-panel-size="50.0"
                  >
                    <div class="flex flex-col h-full w-full">
                      <div
                        class="panel-header border-b border-tk-elements-app-borderColor justify-between"
                      >
                        <div class="panel-title">
                          <div class="panel-icon i-ph-lightning-duotone"></div>
                          <span class="text-sm">Preparing Environment</span>
                        </div>
                        <button
                          class="panel-button px-2 py-0.5 -mr-1 -my-1"
                          title="Toggle Terminal"
                        >
                          <span
                            class="panel-button-icon i-ph-terminal-window-duotone"
                          ></span
                          ><span class="text-sm">Toggle Terminal</span>
                        </button>
                      </div>
                      <div
                        class="flex-grow w-full flex justify-center items-center text-sm bg-tk-elements-app-backgroundColor text-tk-elements-app-textColor"
                      >
                        <ul class="space-y-1">
                          <li class="flex items-center">
                            <div
                              class="inline-block mr-2 i-ph-circle-duotone scale-120 text-tk-elements-status-disabled-iconColor"
                            ></div>
                            <span
                              class="text-tk-elements-status-disabled-textColor"
                              >Installing dependencies</span
                            >
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                  <div
                    class="_PanelResizeHandle_1dq9w_1"
                    role="separator"
                    style="touch-action: none; user-select: none"
                    tabindex="0"
                    data-panel-group-direction="vertical"
                    data-panel-group-id=":r2R0:"
                    data-resize-handle=""
                    data-resize-handle-state="inactive"
                    data-panel-resize-handle-enabled="true"
                    data-panel-resize-handle-id=":r2R9:"
                  ></div>
                  <div
                    class="border-t border-tk-elements-app-borderColor"
                    id="terminal-closed"
                    style="
                      flex-basis: 0;
                      flex-grow: 0;
                      flex-shrink: 1;
                      overflow: hidden;
                    "
                    data-panel=""
                    data-panel-collapsible="true"
                    data-panel-group-id=":r2R0:"
                    data-panel-id="terminal-closed"
                    data-panel-size="0.0"
                  >
                    <div
                      class="panel-container bg-tk-elements-app-backgroundColor"
                    >
                      <div class="panel-tabs-header overflow-x-hidden">
                        <div class="panel-title w-full">
                          <ul
                            class="flex h-full border-b border-tk-elements-app-borderColor w-full"
                            role="tablist"
                            aria-orientation="horizontal"
                          >
                            <li>
                              <button
                                class="group h-full px-4 flex items-center gap-1.5 whitespace-nowrap text-sm position-relative border-r border-tk-elements-panel-headerTab-borderColor bg-tk-elements-panel-headerTab-backgroundColorActive text-tk-elements-panel-headerTab-textColorActive border-tk-elements-panel-headerTab-borderColorActive shadow-[0px_1px_0px_0px] shadow-tk-elements-panel-headerTab-backgroundColorActive"
                                title="Terminal"
                                aria-selected="true"
                              >
                                <span
                                  class="text-tk-elements-panel-headerTab-iconColor i-ph-terminal-window-duotone text-tk-elements-panel-headerTab-iconColorActive"
                                ></span
                                >Terminal
                              </button>
                            </li>
                          </ul>
                        </div>
                      </div>
                      <div class="h-full overflow-hidden"></div>
                    </div>
                  </div>
                </div>
                <!--astro:end--></astro-island
              >
            </div>
          </div>
          <div class="divider" data-astro-cid-6uew3run></div>
        </div>
      </resizable-panel>
    </main>
  </body>
</html>
